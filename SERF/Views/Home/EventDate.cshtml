@model SERF.Models.EventDate

@Styles.Render("~/Content/bootstrap.css")
@Scripts.Render("~/Scripts/jquery-3.4.1.js")
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>

<div class="container">
    <table class="table table-striped table-bordered" id="table">
        <tr>
            <th>Select</th>
            <th>Date</th>
            <th>Start</th>
            <th>End</th>
            <th>Attendence Count</th>
            <th>Alcohol</th>
            <th>Details</th>
        </tr>
    </table>
    <div class="form-group">
        <button class="btn btn-success add-row">Add</button>
        <button class="btn btn-danger delete-row">Delete</button>
    </div>
</div>
<br>
<div class="container">
    @using (Html.BeginForm())
    {
        <div class="form-group">
            <label>Date</label>
            <input class="form-control" type="date" id="Date">
        </div>
        <div class="form-group">
            <label>BegTime</label>
            <input class="form-control" type="time" id="BegTime">
        </div>
        <div class="form-group">
            <label>EndTime</label>
            <input class="form-control" type="time" id="EndTime">
        </div>
        <div class="form-group">
            <label>AttendenceCount</label>
            <input class="form-control" type="number" id="AttendenceCount">
        </div>
        <div class="form-group">
            <label>Alcohol</label>
            <input class="form-control" type="text" id="Alcohol">
        </div>
        <div class="form-group">
            <label>Detail</label>
            <input class="form-control" type="text" id="Detail">
        </div>

        <div class="form-group">
            <input type="submit" value="Next" class="btn btn-default" id="btnSubmit" />
        </div>
    }

    <div class="progress">
        <div class="progress-bar bg-success" role="progressbar" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100" style="width: 50%"></div>
    </div>
    <div>
        @Html.ActionLink("Back to List", "Index")
    </div>
</div>


<script>
    var input = [];
    $(document).ready(function () {
        $(".add-row").click(function () {
            var date = $("#Date").val();
            var beg = $("#BegTime").val();
            var end = $("#EndTime").val();
            var attendence = $("#AttendenceCount").val();
            var alcohol = $("#Alcohol").val();
            var detail = $("#Detail").val();

            var item = { "Date": date, "BegTime": beg, "EndTime": end, "AttendenceCount": attendence, "Alcohol": alcohol, "Details": detail };
            console.log(item);
            input.push(item);
            console.log(input);

            var markup = "<tr><td><input type='checkbox' name='record'></td><td>" + date +
                "</td><td>" + beg + "</td><td>" + end + "</td><td>" + attendence + "</td><td>" +
                alcohol + "</td><td>" + detail + "</td></tr>";
            $("table tbody").append(markup);
        });

        // Find and remove selected table rows
        $(".delete-row").click(function () {
            $("table tbody").find('input[name="record"]').each(function () {
                if ($(this).is(":checked")) {
                    $(this).parents("tr").remove();
                    data.pop(this);
                }
            });
        });
    });
    $(function () {
        $("#btnSubmit").click(function () {
            var formData = new FormData();
            formData.append("Data", input);
            $.ajax({
                url: "/Home/EventDate",
                type: 'POST',
                cache: false,
                contentType: "application/json; charset=utf-8",
                processData: false,
                data: JSON.stringify(formData)
            });
        });
    });
</script>